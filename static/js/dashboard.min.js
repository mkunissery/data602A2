var refresh_page=0,check_rates=!0,set_buy_rate=0,current_rate=0,current_rates=!1,current_tp_rate=0,current_stop_loss_rate=0,current_time=0,current_market=!1,current_coin=!1,current_period=1800,do_not_ajax_now=!1,running_start_time=0,cryptohopper_output_id=!1,donot_switch_enable_hopper=!1,donot_switch_enable_selling=!1,donot_switch_enable_buying=!1,socket_status="Not connected to sockets",showing_sockets_popover=!1,hideLastMessageVal=0,scrolling_through_output=!1,last_rate_update=!1,refresh_data_error=
0,per_cur_totals=!1,other_coins=!1,text_summary_costs=!1,text_summary_average_perc=!1,text_summary_average_hold=!1,text_summary_open_positions=!1,nextRunInterval=!1,nextRunIntervalDiv=!1,refresh_from_datatables=!1,added_datatables_events=!1,assets_only_show_coin=!1,action_from_bulk=!1,current_output_order=[0,"desc"],output_table=!1,output_daterange_selected=!1,output_daterange_init=!1,show_buy_success_message=!1,show_sell_success_message=!1,already_getting_orders=!1,already_getting_pos=!1,already_getting_summary=
!1,already_checking_pos=!1,removepos=!1,track_hopper_run_time=!1,previous_position_rates={},last_position_checks={},first_start_shown=!1,socket=io.connect("https://sockets.cryptohopper.com",{path:"/socket.io",secure:!0});socket.on("connect",function(){showSocketStatus(1);socket.emit("chat",connect_chat);socket.emit("chat",cur_exchange)});socket.on("message",function(a){socketMessagesHandler(a)});socket.on("disconnect",function(){showSocketStatus(0)});
function showSocketStatusPopover(){showing_sockets_popover?(jQuery("#sockets_connected_button").popover("hide"),showing_sockets_popover=!1):(jQuery("#sockets_connected_button").popover({trigger:"manual",placement:"bottom",content:socket_status}),jQuery("#sockets_connected_button").popover("show"),showing_sockets_popover=!0)}
function showFirstStart(){first_start_shown||(first_start_shown=!0,Cookies.get("noshow_firststart")||new Custombox.open({effect:"door",target:"#first-start-hopper",overlaySpeed:100,overlayColor:"#36404a"}),jQuery.ajax({type:"GET",dataType:"json",url:"/siteapi.php?todo=firststartshown",cache:!1,success:function(a){}}))}
function doNotShowFirstStart(){jQuery("#do_not_show_firststart").prop("checked")?Cookies.set("noshow_firststart",1,{path:"/",secure:!0,expires:365}):Cookies.set("noshow_firststart",0,{path:"/",secure:!0,expires:365})}
function showSocketStatus(a){1==a?(jQuery("#sockets_connected_button").data("content","Connected to sockets").html('<i class="md md-signal-wifi-4-bar text-success"></i>'),socket_status="Connected to sockets"):(jQuery("#sockets_connected_button").data("content","Not connected to sockets").html('<i class="md md-signal-wifi-off text-danger"></i>'),socket_status="Not connected to sockets")}
function checkToLongRunning(){3E5<(window.performance&&window.performance.now&&window.performance.timing&&window.performance.timing.navigationStart?window.performance.now()+window.performance.timing.navigationStart:Date.now())-running_start_time&&(refresh_page=1,setHopperRunning(0,hopper_last_run,0))}
function socketMessagesHandler(a){a=JSON.parse(a);if("hopperstatus"==a.type)0==a.result&&1==a.refresh?refresh_page=1:1==a.result&&(running_start_time=window.performance&&window.performance.now&&window.performance.timing&&window.performance.timing.navigationStart?window.performance.now()+window.performance.timing.navigationStart:Date.now(),setTimeout(checkToLongRunning,3E5)),setHopperRunning(a.result,a.last_run,a.sec_left);else if("ticker"==a.type){var b=window.performance&&window.performance.now&&
window.performance.timing&&window.performance.timing.navigationStart?window.performance.now()+window.performance.timing.navigationStart:Date.now();(!last_rate_update||4E3<=b-last_rate_update)&&a.result&&""!=a.result&&(last_rate_update=window.performance&&window.performance.now&&window.performance.timing&&window.performance.timing.navigationStart?window.performance.now()+window.performance.timing.navigationStart:Date.now(),showRates({ticker:a.result}),1==live_hopper&&checkOpenPositionsForSells())}else if("hopperstats"==
a.type)refreshProfitTrackingStats(a.total_invest,a.total_returns,a.percent_change);else if("hopperassets"==a.type)refreshBalances(a.result);else if("hopperoutput"==a.type)hopperLogOutput(a);else if("hopperfirststart"==a.type)showFirstStart();else if("refreshpos"==a.type)setTimeout(refreshPositionsAndOrders,200);else if("refreshordersonly"==a.type)setTimeout(refreshOrdersOnly,200);else if("sellorder"==a.type)"manually-sold"==a.result.trigger&&0==a.result.bundled&&show_sell_success_message&&(show_sell_success_message=
!1,swal({title:"Sell order placed",text:"Placed sell order on market: "+a.result.pair+" at rate: "+a.result.rate+" amount: "+a.result.amount+" total "+a.result.val+".",timer:3E3,type:"success"})),updatePosition({type:"sellpos",position_id:a.result.position_id,val:a.result.order_id}),setTimeout(refreshOrdersOnly,200);else if("buyorder"==a.type)"manual-buy"==a.result.trigger&&show_buy_success_message&&(show_buy_success_message=!1,swal({title:"Buy order placed",text:"Placed order on market: "+a.result.pair+
" at rate: "+a.result.rate+" amount: "+a.result.amount+" total "+a.result.val+". When the order is filled it will be added to your positions by your hopper.",timer:3E3,type:"success"})),setTimeout(refreshOrdersOnly,200);else if("hopperoutputlog"==a.type)1==hopper_live_output&&appendToHopperLog(a.result,a.msg_type,a.log_time);else if("hoppersignaloutput"==a.type)hopperSignalLogOutput(a);else if("hoppertotal"==a.type)refreshTotalInAssets(a.total_btc,a.total_cur,a.percent_change);else if("positionupdate"==
a.type)updatePosition(a.result);else if("walletscrubfinish"==a.type)finishWalletScrubber();else if("positionupdates"==a.type)for(b=0;b<a.result.length;b++)updatePosition(a.result[b]);else if("orderupdate"==a.type)updateOrder(a.result);else if("orderupdates"==a.type)for(b=0;b<a.result.length;b++)updateOrder(a.result[b]);else"new_target"==a.type?loadNewTargetResult(a):"search_target"==a.type?searchingTarget():"removemanualtarget"==a.type?manualTargetRemoved():"hopperstartbalance"==a.type?refreshStartBalance(a.result):
"hopperstatuschange"==a.type?setHopperStatusOf(a.status_type,a.status):"hoppererror"==a.type&&swal({title:a.title,text:a.text,timer:a.timer,type:a.message_type})}
function setHopperStatusOf(a,b){"selling"==a?1==b?(jQuery("#switch_enable_selling").prop("checked",!0),fireEventSwitchery("switch_enable_selling"),enableDisableSellingStatus(0)):(jQuery("#switch_enable_selling").prop("checked",!1),fireEventSwitchery("switch_enable_selling"),enableDisableSellingStatus(1)):"buying"==a?1==b?(jQuery("#switch_enable_buying").prop("checked",!0),fireEventSwitchery("switch_enable_buying"),enableDisableBuyingStatus(0)):(jQuery("#switch_enable_buying").prop("checked",!1),fireEventSwitchery("switch_enable_buying"),
enableDisableBuyingStatus(1)):"hopper"==a&&(1==b?jQuery("#switch_enable_hopper").prop("checked",!0):jQuery("#switch_enable_hopper").prop("checked",!1),fireEventSwitchery("switch_enable_hopper"),enableDisableHopperStatus(b))}
function searchingTarget(){jQuery("#searching_target_spinner").removeClass("md md-gps-fixed md-location-searching text-success").addClass("fa fa-refresh fa-spin").css("margin-top","0px");jQuery("#current_target_coin").removeClass("text-success").addClass("text-inverse").text("Searching...");jQuery("#removeCurrentTarget").hide()}
function loadNewTargetResult(a){var b=!1;jQuery("#removeCurrentTarget").show();var c=!1;1==a.multiple&&(c=!0);c?(c=a.first_target,c=a.new_target.join("<br>"),jQuery("#searching_target_spinner").fadeOut(100).removeClass("fa fa-refresh fa-spin md-location-searching").addClass("md md-gps-fixed text-success").css("margin-top","-10px").fadeIn(100),jQuery("#current_target_coin").fadeOut(100).removeClass("text-inverse").addClass("text-success").html(c).fadeIn(100),jQuery("#removeCurrentTarget").show(),b=
jQuery.trim(a.first_target),b=b.toUpperCase()):a.new_target&&""!=jQuery.trim(a.new_target)?(jQuery("#searching_target_spinner").fadeOut(100).removeClass("fa fa-refresh fa-spin md-location-searching").addClass("md md-gps-fixed text-success").css("margin-top","-10px").fadeIn(100),jQuery("#current_target_coin").fadeOut(100).removeClass("text-inverse").addClass("text-success").text(a.new_target).fadeIn(100),jQuery("#removeCurrentTarget").show(),b=jQuery.trim(a.new_target),b=b.toUpperCase()):(jQuery("#searching_target_spinner").removeClass("fa fa-refresh md md-gps-fixed fa-spin text-success").addClass("md md-location-searching").css("margin-top",
"-10px"),jQuery("#current_target_coin").removeClass("text-success").addClass("text-inverse").text("No target found"),jQuery("#removeCurrentTarget").hide());a.last_check&&jQuery("#currentTargetLastCheck").html(getDateTime(a.last_check));var d="";""!==a.current_sells&&0<a.current_sells.length&&(d+='<hr><p><strong>Sell signals:</strong></p><p><span style="color:#FF0000"><strong>',c=a.current_sells.split(","),d+=c.join(", "),d+="</strong></span></p>");if(a.ta_values){a=a.ta_values;d+='<hr><div class="row"><div class="col-xs-7"><label>Show signals for:</label><br><select id="view_current_target_ta" onchange="viewCurrentTargetTa()" class="form-control">';
var f=0;jQuery.each(a,function(a,c){d+='<option value="'+a+'"';b&&b==jQuery.trim(a)?d+=" selected":b||0==f&&(d+=" selected");d+=">"+a+"</option>";f++});d+='</select></div><div class="col-xs-5 text-right" style="padding:30px 10px 0 0;"><a onclick="scrollCurrentTarget(\'down\')" class="pull-right" style="cursor:pointer"><i class="fa fa-chevron-circle-down" style="font-size:24px"></i></a><a onclick="scrollCurrentTarget(\'up\')" class="m-r-5 pull-right" style="cursor:pointer"><i class="fa fa-chevron-circle-up" style="font-size:24px"></i></a></div></div><hr>';
f=0;jQuery.each(a,function(a,c){d+='<div id="current_ta_result_signals_'+a+'" class="current_ta_result_signals"';b&&b!=jQuery.trim(a)?d+=' style="display:none;"':b||0!=f&&(d+=' style="display:none;"');d+=">";jQuery.each(c.values,function(a,b){d+='<div class="row"><div class="col-sm-4 header-title m-t-0 m-b-10">'+a+'</div><div class="col-sm-4 text-dark header-title m-t-0 m-b-15">';"object"===typeof b&&null!==b?jQuery.each(b,function(a,b){d+=a+": "+parseFloat(b).toFixed(8)+"<br>"}):d+=b;d+='</div><div class="col-sm-4 text-dark header-title m-t-0 m-b-15">';
a in c.signals&&("buy"==c.signals[a]?d+='<span class="text-success">Buy</span>':"sell"==c.signals[a]?d+='<span class="text-danger">Sell</span>':"neutral"==c.signals[a]&&(d+='<span class="text-inverse">Neutral</span>'));d+="</div></div>"});d+="</div>";f++});d+="<hr>";jQuery("#current_target_ta_values_result").fadeOut(100).html(d).fadeIn(100)}else jQuery("#current_target_ta_values_result").fadeOut(100).html(d)}
function viewCurrentTargetTa(){var a=jQuery("#view_current_target_ta option:selected").val();jQuery(".current_ta_result_signals").hide();jQuery("#current_ta_result_signals_"+a).show()}
function updateOrder(a){var b=parseInt(a.id);0<b&&"removeorder"==a.type&&(jQuery("#openorders_modals .modal").modal("hide"),jQuery("#open_order_"+a.pair+"_"+b).remove(),0>=jQuery("#datatable-openorders tbody tr").length&&jQuery("#openorders .portlet-body").html('<p class="m-l-10 text-muted">No current active/open orders placed by Cryptohopper.</p>'))}
function updatePosition(a){var b=parseInt(a.position_id);if(0<b)if("stop-loss"==a.type){jQuery("#trade_modal_"+b+" .position_data").data("stop-loss",a.val);var c=jQuery("#trade_modal_"+b+" .position_data").data("rate");a=parseFloat(a.val)>=parseFloat(c)?'<span class="text-success">'+a.val+"</span>":'<span class="text-danger">'+a.val+"</span>";jQuery("#trade_modal_"+b+" .stop-loss-rate").html(a)}else"sellpos"==a.type?(jQuery("#pos_sell_order_id_"+b).val(a.val),jQuery("#trade_modal_"+b+" .sellButton").parent().prepend("Sell order placed "),
jQuery("#trade_modal_"+b+" .sellButton").remove(),jQuery("#posTableI_"+b+" .sellButton").parent().prepend("Sell order placed "),jQuery("#posTableI_"+b+" .sellButton").remove()):"removepos"==a.type&&(jQuery("#pos_modals .modal").modal("hide"),open_pos_table&&jQuery("#posTableI_"+b).fadeOut(100,function(){open_pos_table.row(jQuery("#posTableI_"+b)).remove();var a=jQuery("#datatable-responsive tbody tr");open_pos_table.rows(a).invalidate();open_pos_table.draw()}),jQuery("#posTableI_"+b).remove(),setTimeout(refreshPositionSummary,
200))}function hopperSignalLogOutput(a){jQuery("#cryptohopper_signal_output").html(a.result)}
function hopperLogOutput(a){jQuery("#lastRunLoader").html('<img src="https://cdn.cryptohopper.com/images/ajax-loader.gif"> Hopper is running');scrolling_through_output||(a.is_new&&jQuery("#cryptohopper_output").html(""),jQuery("#cryptohopper_output").append(a.log));jQuery("#cryptohopper_last_message").slideDown();"error"==a.msgtype?jQuery("#cryptohopper_last_message").addClass("alert-danger").removeClass("alert-info").html(a.result):jQuery("#cryptohopper_last_message").addClass("alert-info").removeClass("alert-danger").html(a.result);
hideLastMessageVal++;"Hopper is finished."==a.result&&setTimeout(hideLastMessage,15E3)}function hideLastMessage(){jQuery("#cryptohopper_last_message").slideUp()}function refreshStartBalance(a){jQuery("#val_startbalance").text(a)}function decimalsToUse(){return"BTC"==collect_currency||"ETH"==collect_currency||"XMR"==collect_currency?8:2}
function refreshBalances(a){var b="";jQuery.each(a,function(a,d){0<d&&(b+="<tr><td><b>"+a+"</b></td><td><b>"+parseFloat(d).toFixed(8)+"</b></td></tr>");a.toUpperCase()==collect_currency.toUpperCase()&&(jQuery("#total_allowed_buy").text(parseFloat(d).toFixed(decimalsToUse())),total_allowed_buy=parseFloat(d).toFixed(decimalsToUse()))});jQuery("#current_assets_table tbody tr").remove();jQuery("#current_assets_table tbody").append(b)}
function refreshOrdersOnly(){if(already_getting_orders)return!1;already_getting_orders=!0;jQuery("#openorders_modals .modal").modal("hide");jQuery("#refreshOrdersButton i").addClass("fa-spin");jQuery.ajax({url:"/siteapi.php?todo=getorders",cache:!1}).done(function(a){already_getting_orders=!1;jQuery("#refreshOrdersButton i").removeClass("fa-spin");1==a.status?loadOrdersOnly(a):"relogin"in a?location.href="/login":1==refresh_data_error?(swal({title:"Error refreshing data",text:"There was an error refreshing the data, please refresh the page. Error message: "+
a.error,timer:4E3,type:"error"}),refresh_data_error=0):0==refresh_data_error&&(refresh_data_error=1,refreshOrdersOnly())})}
function refreshPositionsAndOrders(){if(already_getting_pos)return!1;jQuery("#pos_modals .modal").modal("hide");jQuery("#refreshPosButton i").addClass("fa-spin");var a=[];jQuery.each(jQuery(".selectAllBulk"),function(b){this.checked&&a.push(this.value)});jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=getposorders",data:{pos_i:a},cache:!1,beforeSend:function(){already_getting_pos=!0},complete:function(){already_getting_pos=!1;jQuery("#refreshPosButton i").removeClass("fa-spin")},success:function(a){1==
a.status?loadPositionsAndOrders(a):"relogin"in a?location.href="/login":1==refresh_data_error?(swal({title:"Error refreshing data",text:"There was an error refreshing the data, please refresh the page. Error message: "+a.error,timer:4E3,type:"error"}),refresh_data_error=0):0==refresh_data_error&&(refresh_data_error=1,refreshPositionsAndOrders())}})}
function refreshPositionSummary(){if(already_getting_summary)return!1;jQuery("#refreshSummaryButton i").addClass("fa-spin");jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=getpossummary",data:{},cache:!1,beforeSend:function(){already_getting_summary=!0},complete:function(){already_getting_summary=!1;jQuery("#refreshSummaryButton i").removeClass("fa-spin")},success:function(a){1==a.status?loadPositionSummary(a):"relogin"in a?location.href="/login":1==refresh_data_error&&swal({title:"Error refreshing data",
text:"There was an error refreshing the data, please refresh the page. Error message: "+a.error,timer:4E3,type:"error"})}})}function changePosTargetRate(a,b){var c=b,d=jQuery("#percentage_profit_"+a).val();c*=1+d/100;jQuery(".target_rate_"+a).text(c.toFixed(8))}
function showTotalsAgain(){do_not_change_stats=assets_only_show_coin=!1;jQuery("#remove_stats_filter").hide();open_pos_table.column(2).search("").draw();jQuery("#summary_total_title").text("Totals current positions");jQuery("#filtered_text_stats").text("These are your current open positions.");jQuery("#summary_text_costs").text(text_summary_costs);jQuery("#summary_text_percs").text(text_summary_average_perc+"%");0>parseFloat(text_summary_average_perc)?jQuery("#summary_text_percs").removeClass("text-success").addClass("text-danger"):
jQuery("#summary_text_percs").removeClass("text-danger").addClass("text-success");jQuery("#summary_text_holds").text(text_summary_average_hold);jQuery("#summary_text_poss").text(text_summary_open_positions)}function loadOrdersOnly(a){setTimeout(function(){loadActiveOrders(a)},250)}
function loadPositionSummary(a){text_summary_costs=a.stats.total_costs;text_summary_average_perc=a.stats.average_perc;text_summary_average_hold=a.stats.average_hold;text_summary_open_positions=a.stats.total_pos;var b=Cookies.get("dash_summary_hide"),c=Cookies.get("dash_summary");assets_only_show_coin&&showTotalsAgain();1!=b&&1==c&&plotAssetsSummary(a.stats.data,a.stats.per_cur_totals,a.stats.other_coins,a.stats.total_costs,a.stats.average_perc,a.stats.average_hold,a.stats.total_pos);0==a.stats.total_pos&&
jQuery("#current-assets").empty()}
function loadPositionsAndOrders(a){jQuery("#openorders_div .modal").modal("hide");jQuery("#openPosTableHolder .modal").modal("hide");setTimeout(function(){loadActiveOrders(a);loadPositionSummary(a);open_pos_table&&0<a.stats.total_pos&&open_pos_table.destroy(!0);if(0<a.stats.total_pos){jQuery("#openPosTableHolder").html(a.open_positions);loadDatatablesOpenPositions();recreateClicks("#openPosTableHolder");jQuery("#openPosTableHolder").load();var b=!1;assets_only_show_coin&&(b=assets_only_show_coin);
b&&showOnlyCoinRows(b)}createPercentageProfitFields();jQuery('#pos_modals [data-plugin="switchery"]').each(function(a,b){var c=jQuery(this).data();"secondarycolor"in c&&(c.secondaryColor=c.secondarycolor);new Switchery(jQuery(this)[0],c)});jQuery("#lastRunDate").text(getDateTime(hopper_last_run));jQuery("#lastRunDiv").show();jQuery("#lastRunLoader").hide();jQuery(".sellDisabledButton").hide();jQuery(".bulkDisabledButton").hide();jQuery(".buyDisabledButton").hide();jQuery(".removeDisabledButton").hide();
jQuery(".cancelDisabledButton").hide();jQuery(".holdPositionSwitch").show();jQuery(".savingButton").text("Save");jQuery(".sellButton").show();jQuery(".bulkActionDiv").show();jQuery(".removeButton").show();jQuery(".cancelButton").show();jQuery(".buyButton").show()},250)}
function loadDatatablesOpenPositions(){0!==jQuery("#datatable-responsive").length&&(open_pos_table=jQuery("#datatable-responsive").DataTable({order:[getSavedOrdering()],responsive:!0,paging:!0,pageLength:parseInt(getSavedPageLength()),columnDefs:[{orderable:!1,targets:[1,7]},{responsivePriority:1,targets:2},{responsivePriority:2,targets:5},{type:"result-calc",targets:5},{type:"age-calc",targets:6}]}),added_datatables_events||(jQuery("#datatable-responsive").on("page.dt",function(){do_not_ajax_now||
(refresh_from_datatables=!0,showHopperRunning(),reloadRates(),refresh_from_datatables=!1)}),jQuery("#datatable-responsive").on("length.dt",function(){do_not_ajax_now||(refresh_from_datatables=!0,showHopperRunning(),reloadRates(),refresh_from_datatables=!1);Cookies.set("dash_length",open_pos_table.page.len(),{path:"/",secure:!0,expires:365})}),jQuery("#datatable-responsive").on("search.dt",function(){do_not_ajax_now||(refresh_from_datatables=!0,showHopperRunning(),reloadRates(),refresh_from_datatables=
!1)}),jQuery("#datatable-responsive").on("order.dt",function(){do_not_ajax_now||(refresh_from_datatables=!0,showHopperRunning(),reloadRates(),refresh_from_datatables=!1);var a=open_pos_table.order();Cookies.set("dash_order_col",a[0][0],{path:"/",secure:!0,expires:365});Cookies.set("dash_order_type",a[0][1],{path:"/",secure:!0,expires:365})}),added_datatables_events=!0))}
function loadActiveOrders(a){jQuery("#openorders .portlet-body").html(a.active_orders);recreateClicks("#openorders");jQuery("#openorders").load()}function formatMoney(a,b,c,d){var f="\\d(?=(\\d{3})+"+(0<b?"\\D":"$")+")";a=a.toFixed(Math.max(0,~~b));return(d?a.replace(".",d):a).replace(new RegExp(f,"g"),"$&"+(c||","))}
function refreshTotalInAssets(a,b,c){a="BTC"==collect_currency?a.toFixed(8).replace(/(\d)(?=(\d{3})+\.)/g,"$1,"):"ETH"==collect_currency||"XMR"==collect_currency?b.toFixed(8).replace(/(\d)(?=(\d{3})+\.)/g,"$1,"):b.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,");jQuery("#val_totalbalance").text(a);jQuery("#val_inassets_percent_change").text(c);0>parseFloat(c)?jQuery("#val_inassets_percent_change").parent().removeClass("text-success").addClass("text-danger"):jQuery("#val_inassets_percent_change").parent().removeClass("text-danger").addClass("text-success")}
function refreshProfitTrackingStats(a,b,c){jQuery("#stats_percent_change").text(c);jQuery("#stats_total_invest").text(a);jQuery("#stats_total_returns").text(b);0>parseFloat(c)?(jQuery("#icon-profit_tracking").removeClass("md-trending-up text-success md-trending-neutral text-inverse").addClass("md-trending-down text-danger"),jQuery("#stats_percent_change").parent().removeClass("text-success text-neutral").addClass("text-danger")):0==parseFloat(c)?(jQuery("#stats_percent_change").parent().removeClass("text-danger text-success").addClass("text-neutral"),
jQuery("#icon-profit_tracking").removeClass("md-trending-up text-success md-trending-down text-danger").addClass("md-trending-neutral text-inverse")):(jQuery("#stats_percent_change").parent().removeClass("text-danger text-neutral").addClass("text-success"),jQuery("#icon-profit_tracking").removeClass("md-trending-down text-success md-trending-neutral text-inverse").addClass("md-trending-up text-success"))}
function loadCryptohopperOutput(a){scrolling_through_output=!0;var b="next";"prev"==a?b="prev":"last"==a&&(b="next",cryptohopper_output_id=!1);jQuery(".nextprev_output_button").prop("disabled",!0);jQuery("#cryptohopper_output").hide();jQuery.ajax({url:"/siteapi.php?todo=loadoutput&this_id="+cryptohopper_output_id+"&to="+b,cache:!1}).done(function(c){jQuery(".nextprev_output_button").prop("disabled",!1);1==c.status?(jQuery("#cryptohopper_output").html(c.result),jQuery("#cryptohopper_output").show(),
cryptohopper_output_id=c.this_id,"last"==a&&jQuery(".nextprev_output_button_next").prop("disabled",!0)):(swal({title:"No output",text:"No more output to retrieve.",timer:3E3,type:"error"}),"prev"==b?jQuery(".nextprev_output_button_prev").prop("disabled",!0):jQuery(".nextprev_output_button_next").prop("disabled",!0))})}
function toggleSellOptionsBuy(){jQuery("#buy_sell_options").is(":visible")?jQuery("#buy_sell_options_icon").removeClass("fa-minus").addClass("fa-plus"):jQuery("#buy_sell_options_icon").addClass("fa-minus").removeClass("fa-plus");jQuery("#buy_sell_options").toggle()}function setHopperRunning(a,b,c){hopper_status=a;hopper_last_run=b;hopper_sec_left=c;showHopperRunning()}
function showHopperRunning(){var a=hopper_last_run;1==hopper_status?(track_hopper_run_time||(track_hopper_run_time=Math.floor(Date.now()/1E3)),refresh_from_datatables||(hideNextRunTimer(),0==hopper_running&&jQuery("#lastRunLoader").html('<img src="https://cdn.cryptohopper.com/images/ajax-loader.gif"> Hopper is starting')),hopper_running=1,jQuery("#lastRunDiv").hide(),jQuery("#lastRunLoader").show(),jQuery(".sellButton").hide(),jQuery(".sync2Button").hide(),jQuery(".removeButton").hide(),jQuery(".buyButton").hide(),
jQuery(".holdPositionSwitch").hide(),jQuery(".cancelButton").hide(),jQuery(".sellDisabledButton").show(),jQuery(".bulkActionDiv").hide(),jQuery('.bulkActionDiv [data-toggle="dropdown"]').parent().removeClass("open"),jQuery(".syncDisabledButton").show(),jQuery(".buyDisabledButton").show(),jQuery(".removeDisabledButton").show(),jQuery(".cancelDisabledButton").show(),jQuery(".bulkDisabledButton").show(),jQuery(".sellDisabledButton").text("Selling disabled"),jQuery(".bulkDisabledButton").text("Bulk disabled"),
jQuery(".savingButton").text("Disabled"),jQuery(".removeDisabledButton").text("Removing disabled"),jQuery(".cancelDisabledButton").text("Cancelling disabled")):(track_hopper_run_time=!1,refresh_from_datatables||startNextRunTimer(),1==hopper_running?1==refresh_page?(jQuery("#autorefreshCheckbox").prop("checked")?(jQuery(".buyButton").show(),jQuery(".sync2Button").show(),jQuery(".sellDisabledButton").text("Refreshing data"),jQuery(".syncDisabledButton").hide(),jQuery(".bulkDisabledButton").text("Refreshing data"),
jQuery(".buyDisabledButton").text("Refreshing data")):(hopper_running=0,jQuery(".buyButton").show(),jQuery(".sync2Button").show(),jQuery(".syncDisabledButton").hide(),jQuery(".sellDisabledButton").text("Refreshing data"),jQuery(".buyDisabledButton").text("Refreshing data"),jQuery(".bulkDisabledButton").text("Refreshing data")),jQuery(".removeDisabledButton").text("Refreshing data"),jQuery(".cancelDisabledButton").text("Refreshing data"),jQuery(".holdPositionSwitch").text("Refreshing data").show(),
refresh_from_datatables||refreshPositionsAndOrders()):(jQuery("#lastRunDate").text(getDateTime(a)),jQuery("#lastRunDiv").show(),jQuery("#lastRunLoader").hide(),jQuery(".sellDisabledButton").hide(),jQuery(".syncDisabledButton").hide(),jQuery(".bulkDisabledButton").hide(),jQuery(".buyDisabledButton").hide(),jQuery(".removeDisabledButton").hide(),jQuery(".cancelDisabledButton").hide(),jQuery(".holdPositionSwitch").show(),jQuery(".savingButton").text("Save"),jQuery(".sellButton").show(),jQuery(".bulkActionDiv").show(),
jQuery(".removeButton").show(),jQuery(".cancelButton").show(),jQuery(".buyButton").show(),jQuery(".sync2Button").show()):0===refresh_page&&(jQuery("#lastRunDate").text(getDateTime(a)),jQuery("#lastRunDiv").show(),jQuery("#lastRunLoader").hide(),jQuery(".sellDisabledButton").hide(),jQuery(".bulkDisabledButton").hide(),jQuery(".syncDisabledButton").hide(),jQuery(".buyDisabledButton").hide(),jQuery(".removeDisabledButton").hide(),jQuery(".cancelDisabledButton").hide(),jQuery(".holdPositionSwitch").show(),
jQuery(".savingButton").text("Save"),jQuery(".sellButton").show(),jQuery(".bulkActionDiv").show(),jQuery(".removeButton").show(),jQuery(".cancelButton").show(),jQuery(".buyButton").show(),jQuery(".sync2Button").show()))}function checkHopperRunning(){jQuery.ajax({url:"/siteapi.php?todo=checkrunning",cache:!1}).done(function(a){1==a.status?setHopperRunning(a.result,a.last_run,a.sec_left):"relogin"in a&&(location.href="/login")})}
function enableProfitTracking(){jQuery("#enable-profit-div-buttons").hide();jQuery("#enable-profit-div-loading").show()}
function sellPos(a){swal({title:"Are you sure?",text:"Are you sure you want to sell this position?",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"Yes, sell position"}).then(function(b){if(!b.value)return!1;jQuery("#posTableI_"+a+" .sellButton").html('<i class="fa fa-refresh fa-spin" style="font-size:inherit;margin:2px 5px 0 0;"></i>');jQuery("#trade_modal_"+a+" .sellButton").html('<i class="fa fa-refresh fa-spin" style="font-size:inherit;margin:2px 5px 0 0;"></i>');
jQuery.ajax({url:"/siteapi.php?todo=sellpos&sellpos="+a,cache:!1}).done(function(b){1==b.status?1==live_hopper?show_sell_success_message=!0:(jQuery("#posTableI_"+a+" .sellButton").after("Sell order placed "),jQuery("#posTableI_"+a+" .sellButton").remove(),jQuery("#posTableI_"+a+" .sellDisabledButton").remove(),jQuery("#trade_modal_"+a+" .sellButton").after("Sell order placed "),jQuery("#trade_modal_"+a+" .sellButton").remove(),jQuery("#trade_modal_"+a+" .sellDisabledButton").remove(),swal({title:"Sell position",
text:b.message,timer:3E3,type:"success"}),refreshOrdersOnly()):(swal({title:"Error",text:b.error,type:"error"}),jQuery("#posTableI_"+a+" .sellButton").html("Sell position"),jQuery("#trade_modal_"+a+" .sellButton").html("Sell position"))})})}
function cancelOpenTSB(a,b,c){swal({title:"Are you sure?",text:"Are you sure you want to cancel this trailing buy order?",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"Yes, cancel order"}).then(function(d){if(!d.value)return!1;jQuery("#open_order_tsb_"+b+"_"+c+" .cancelOpenOrderButton").html('<i class="fa fa-refresh fa-spin"></i>');jQuery("#openorder_modal_tsb_"+b+"_"+c+" .cancelOpenOrderButton").html('<i class="fa fa-refresh fa-spin"></i>');jQuery.ajax({url:"/siteapi.php?todo=canceltsb&order_id="+
a,cache:!1}).done(function(a){jQuery("#openorders_modals .modal").modal("hide");1==a.status?setTimeout(function(){refreshOrdersOnly()},1E3):(swal({title:"Error",text:a.error,type:"error"}),jQuery("#open_order_tsb_"+b+"_"+c+" .cancelOpenOrderButton").html("Cancel order"),jQuery("#openorder_modal_tsb_"+b+"_"+c+" .cancelOpenOrderButton").html("Cancel order"))})})}
function removeOpenTSB(a,b,c){swal({title:"Are you sure?",text:"Are you sure you want to remove this trailing buy order from Cryptohopper?",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"Yes, remove order"}).then(function(d){if(!d.value)return!1;jQuery("#open_order_tsb_"+b+"_"+c+" .removeOpenOrderButton").html('<i class="fa fa-refresh fa-spin"></i>');jQuery("#openorder_modal_tsb_"+b+"_"+c+" .removeOpenOrderButton").html('<i class="fa fa-refresh fa-spin"></i>');
jQuery(".modal").modal("hide");jQuery.ajax({url:"/siteapi.php?todo=canceltsb&order_id="+a,cache:!1}).done(function(a){1==a.status?(jQuery("#openorders_modals .modal").modal("hide"),setTimeout(function(){refreshOrdersOnly()},1E3)):(swal({title:"Error",text:a.error,type:"error"}),jQuery("#open_order_tbs_"+b+"_"+c+" .removeOpenOrderButton").html("Remove order"),jQuery("#openorder_modal_tbs_"+b+"_"+c+" .removeOpenOrderButton").html("Remove order"))})})}
function cancelOpenOrder(a,b,c){swal({title:"Are you sure?",text:"Are you sure you want to cancel this order?",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"Yes, cancel order"}).then(function(d){if(!d.value)return!1;jQuery("#open_order_"+b+"_"+c+" .cancelOpenOrderButton").html('<i class="fa fa-refresh fa-spin"></i>');jQuery("#openorder_modal_"+b+"_"+c+" .cancelOpenOrderButton").html('<i class="fa fa-refresh fa-spin"></i>');jQuery.ajax({url:"/siteapi.php?todo=cancelorder&order_id="+
a,cache:!1}).done(function(a){jQuery("#openorders_modals .modal").modal("hide");1==a.status?setTimeout(function(){refreshOrdersOnly()},1E3):(swal({title:"Error",text:a.error,type:"error"}),jQuery("#open_order_"+b+"_"+c+" .cancelOpenOrderButton").html("Cancel order"),jQuery("#openorder_modal_"+b+"_"+c+" .cancelOpenOrderButton").html("Cancel order"))})})}
function removeOpenOrder(a,b,c){swal({title:"Are you sure?",text:"Are you sure you want to remove this order from Cryptohopper?",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"Yes, remove order"}).then(function(d){if(!d.value)return!1;jQuery("#open_order_"+b+"_"+c+" .removeOpenOrderButton").html('<i class="fa fa-refresh fa-spin"></i>');jQuery("#openorder_modal_"+b+"_"+c+" .removeOpenOrderButton").html('<i class="fa fa-refresh fa-spin"></i>');jQuery(".modal").modal("hide");
jQuery.ajax({url:"/siteapi.php?todo=removeorder&order_id="+a,cache:!1}).done(function(a){1==a.status?(jQuery("#open_order_"+b+"_"+c).remove(),jQuery("#openorder_modal_"+b+"_"+c).remove(),0>=jQuery("#datatable-openorders tbody tr").length&&jQuery("#openorders .portlet-body").html('<p class="m-l-10 text-muted">No current active/open orders placed by Cryptohopper.</p>')):(swal({title:"Error",text:a.error,type:"error"}),jQuery("#open_order_"+b+"_"+c+" .removeOpenOrderButton").html("Remove order"),jQuery("#openorder_modal_"+
b+"_"+c+" .removeOpenOrderButton").html("Remove order"))})})}
function resetProfitTracking(){swal({title:"Reset your invested and returns stats?",text:"Are you sure you want to reset your invested and returns statistics? The current stats will be removed.",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"Yes, reset stats"}).then(function(a){if(!a.value)return!1;jQuery("#resetProfitLink").html('<i class="fa fa-refresh fa-spin" style="font-size:inherit;margin:2px 5px 0 0;"></i>');jQuery.ajax({url:"/siteapi.php?todo=resetprofittracking",
cache:!1}).done(function(a){1==a.status?(jQuery("#resetProfitLink").html('<i class="fa fa-check m-r-5" style="font-size:inherit;margin:2px 5px 0 0;"></i> resetted'),refreshProfitTrackingStats(0,0,0)):jQuery("#resetProfitLink").html('<i class="fa fa-times m-r-5" style="font-size:inherit;margin:2px 5px 0 0;"></i> '+a.error);setTimeout(function(){jQuery("#resetProfitLink").html("reset")},3E3)})})}
function removePos(a){swal({title:"Are you sure?",text:"Are you sure you want to remove this position?",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"Yes, remove position"}).then(function(b){if(!b.value)return!1;jQuery("#trade_modal_"+a+" .removeButton").html('<i class="fa fa-refresh fa-spin" style="font-size:inherit;margin:2px 5px 0 0;"></i>');jQuery.ajax({url:"/siteapi.php?todo=removepos&removepos="+a,cache:!1}).done(function(b){1==b.status?(jQuery("#pos_modals .modal").modal("hide"),
swal({title:"Position removed",text:"The position has been removed.",timer:3E3,type:"success"}),removepos=a,setTimeout(function(){jQuery("#posTableI_"+removepos).remove();open_pos_table.row("#posTableI_"+removepos).remove().draw();jQuery("#trade_modal_"+removepos).remove();removepos=!1},300),setTimeout(refreshPositionSummary,200)):(swal({title:"Error",text:b.error,type:"error"}),jQuery("#posTableI_"+a+" .removeButton").html("Remove position"))})})}
function sellMultiplePos(){swal({title:"Are you sure?",text:"Are you sure you want to sell the selected positions?",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"Yes, sell positions"}).then(function(a){if(!a.value)return!1;var b=[];jQuery.each(jQuery(".selectAllBulk"),function(a){this.checked&&b.push(this.value)});0<b.length?jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=bulksell",data:{pos_i:b},cache:!1,beforeSend:function(){jQuery("#bulkDropdown").html('<i class="fa fa-refresh fa-spin"></i>');
for(var a=0;a<b.length;a++){var d=b[a];jQuery("#posTableI_"+d+" .sellButton").html('<i class="fa fa-refresh fa-spin" style="font-size:inherit;margin:2px 5px 0 0;"></i>');jQuery("#trade_modal_"+d+" .sellButton").html('<i class="fa fa-refresh fa-spin" style="font-size:inherit;margin:2px 5px 0 0;"></i>')}},complete:function(){jQuery("#bulkDropdown").html('Bulk actions <span class="caret"></span>')},success:function(a){if(1==a.status){swal({title:"Done",text:a.message,timer:3E3,type:"success"});for(a=
0;a<b.length;a++){var c=b[a];jQuery("#posTableI_"+c+" .sellButton").after("Sell order placed ");jQuery("#posTableI_"+c+" .sellButton").remove();jQuery("#trade_modal_"+c+" .sellButton").after("Sell order placed ");jQuery("#trade_modal_"+c+" .sellButton").remove()}refreshPositionsAndOrders()}else for(swal({title:"Error",text:a.error,type:"error"}),a=0;a<b.length;a++)c=b[a],jQuery("#posTableI_"+c+" .sellButton").html("Sell position"),jQuery("#trade_modal_"+c+" .sellButton").html("Sell position")}}):
setTimeout(function(){swal({title:"No positions selected",text:"No positions selected. Please select 1 or more positions.",type:"error"})},200)})}
function bulkMergePos(){swal({title:"Are you sure?",text:"Are you sure you want to merge the selected positions? This will remove profit tracking and buy trigger data on the selected positions.",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"Yes, merge positions"}).then(function(a){if(!a.value)return!1;var b=[];jQuery.each(jQuery(".selectAllBulk"),function(a){this.checked&&b.push(this.value)});1<b.length?jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=bulkmerge",
data:{pos_i:b},cache:!1,beforeSend:function(){jQuery("#bulkDropdown").html('<i class="fa fa-refresh fa-spin"></i>')},complete:function(){jQuery("#bulkDropdown").html('Bulk actions <span class="caret"></span>')},success:function(a){1==a.status?(swal({title:"Done",text:"Selected positions have been merged.",timer:3E3,type:"success"}),jQuery(".selectAllBulk").prop("checked",!1),refreshPositionsAndOrders()):swal({title:"Error",text:a.error,type:"error"})}}):setTimeout(function(){swal({title:"No positions selected",
text:"No positions selected. Please select 2 or more positions to merge.",type:"error"})},200)})}
function bulkDCAPos(){swal({title:"Are you sure?",text:"Are you sure you want to create a DCA order for the selected positions? A DCA order will be double the amount of your current total.",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"Yes, create DCA order"}).then(function(a){if(!a.value)return!1;var b=[];jQuery.each(jQuery(".selectAllBulk"),function(a){this.checked&&b.push(this.value)});0<b.length?jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=bulkdca",
data:{pos_i:b},cache:!1,beforeSend:function(){jQuery("#bulkDropdown").html('<i class="fa fa-refresh fa-spin"></i>')},complete:function(){jQuery("#bulkDropdown").html('Bulk actions <span class="caret"></span>')},success:function(a){1==a.status?(swal({title:"Done",text:"DCA orders will be created for the selected positions.",timer:3E3,type:"success"}),jQuery(".selectAllBulk").prop("checked",!1),refreshPositionsAndOrders()):swal({title:"Error",text:a.error,type:"error"})}}):setTimeout(function(){swal({title:"No positions selected",
text:"No positions selected. Please select 1 or more positions to merge.",type:"error"})},200)})}
function splitPos(a){swal({title:"Are you sure?",text:"Are you sure you want to split this position?",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"Yes, split position"}).then(function(b){if(!b.value)return!1;b=[];b.push(a);jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=bulksplit",data:{pos_i:b},cache:!1,beforeSend:function(){jQuery("#bulkDropdown").html('<i class="fa fa-refresh fa-spin"></i>')},complete:function(){jQuery("#bulkDropdown").html('Bulk actions <span class="caret"></span>')},
success:function(a){1==a.status?(jQuery("#pos_modals .modal").modal("hide"),swal({title:"Done",text:"Selected positions have been splitted.",timer:3E3,type:"success"}),jQuery(".selectAllBulk").prop("checked",!1),refreshPositionsAndOrders()):swal({title:"Error",text:a.error,type:"error"})}})})}
function bulkSplitPos(){swal({title:"Are you sure?",text:"Are you sure you want to split the selected positions?",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"Yes, split positions"}).then(function(a){if(!a.value)return!1;var b=[];jQuery.each(jQuery(".selectAllBulk"),function(a){this.checked&&b.push(this.value)});0<b.length?jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=bulksplit",data:{pos_i:b},cache:!1,beforeSend:function(){jQuery("#bulkDropdown").html('<i class="fa fa-refresh fa-spin"></i>')},
complete:function(){jQuery("#bulkDropdown").html('Bulk actions <span class="caret"></span>')},success:function(a){1==a.status?(swal({title:"Done",text:"Selected positions have been splitted.",timer:3E3,type:"success"}),jQuery(".selectAllBulk").prop("checked",!1),refreshPositionsAndOrders()):swal({title:"Error",text:a.error,type:"error"})}}):setTimeout(function(){swal({title:"No positions selected",text:"No positions selected. Please select 1 or more positions.",type:"error"})},200)})}
function bulkUnholdPos(){swal({title:"Are you sure?",text:"Are you sure you want remove the hold on the selected positions?",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"Yes, unhold positions"}).then(function(a){if(!a.value)return!1;var b=[];jQuery.each(jQuery(".selectAllBulk"),function(a){this.checked&&b.push(this.value)});0<b.length?jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=bulkhold",data:{hold:0,pos_i:b},cache:!1,beforeSend:function(){jQuery("#bulkDropdown").html('<i class="fa fa-refresh fa-spin"></i>')},
complete:function(){jQuery("#bulkDropdown").html('Bulk actions <span class="caret"></span>')},success:function(a){if(1==a.status){swal({title:"Done",text:"Selected positions will not be holded anymore.",timer:3E3,type:"success"});action_from_bulk=!0;for(a=0;a<b.length;a++){var c=b[a];jQuery("#hold_position_"+c).prop("checked",!1);fireEventSwitchery("hold_position_"+c)}action_from_bulk=!1}else swal({title:"Error",text:a.error,type:"error"})}}):setTimeout(function(){swal({title:"No positions selected",
text:"No positions selected. Please select 1 or more positions.",type:"error"})},200)})}
function bulkHoldPos(){swal({title:"Are you sure?",text:"Are you sure you want to hold the selected positions?",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"Yes, hold positions"}).then(function(a){if(!a.value)return!1;var b=[];jQuery.each(jQuery(".selectAllBulk"),function(a){this.checked&&b.push(this.value)});0<b.length?jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=bulkhold",data:{hold:1,pos_i:b},cache:!1,beforeSend:function(){jQuery("#bulkDropdown").html('<i class="fa fa-refresh fa-spin"></i>')},
complete:function(){jQuery("#bulkDropdown").html('Bulk actions <span class="caret"></span>')},success:function(a){if(1==a.status){swal({title:"Done",text:"Selected positions will be holded from now on.",timer:3E3,type:"success"});action_from_bulk=!0;for(a=0;a<b.length;a++){var c=b[a];jQuery("#hold_position_"+c).prop("checked",!0);fireEventSwitchery("hold_position_"+c)}action_from_bulk=!1}else swal({title:"Error",text:a.error,type:"error"})}}):setTimeout(function(){swal({title:"No positions selected",
text:"No positions selected. Please select 1 or more positions.",type:"error"})},200)})}function fireEventSwitchery(a){a=document.getElementById(a);if("function"!==typeof Event&&document.fireEvent)a.fireEvent("onchange");else{var b=document.createEvent("HTMLEvents");b.initEvent("change",!0,!0);a.dispatchEvent(b)}}
function removeMultiplePos(){swal({title:"Are you sure?",text:"Are you sure you want to remove the selected positions?",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"Yes, remove positions"}).then(function(a){if(!a.value)return!1;var b=[];jQuery.each(jQuery(".selectAllBulk"),function(a){this.checked&&b.push(this.value)});0<b.length?jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=bulkremove",data:{pos_i:b},cache:!1,beforeSend:function(){jQuery("#bulkDropdown").html('<i class="fa fa-refresh fa-spin"></i>')},
complete:function(){jQuery("#bulkDropdown").html('Bulk actions <span class="caret"></span>')},success:function(a){if(1==a.status){swal({title:"Done",text:"Selected positions have been removed.",timer:3E3,type:"success"});for(a=0;a<b.length;a++){var c=b[a];jQuery("#posTableI_"+c).remove();jQuery("#trade_modal_"+c).remove();open_pos_table.row("#posTableI_"+c).remove().draw(!1)}refreshPositionsAndOrders()}else swal({title:"Error",text:a.error,type:"error"})}}):setTimeout(function(){swal({title:"No positions selected",
text:"No positions selected. Please select 1 or more positions.",type:"error"})},200)})}function reloadRates(){refresh_from_datatables||(current_rates?showRates(current_rates):refreshRates())}function getCorrectRateToUse(a,b){return"last"==ticker_type?"highestBid"==b?a.last>a.highestBid?a.last:a.highestBid:a.last<a.lowestAsk?a.last:a.lowestAsk:"lastalways"==ticker_type?a.last:"highestBid"==b?a.highestBid:a.lowestAsk}
function checkOpenPositionsForSells(){if(!current_rates||0==hopper_enabled||0==selling_enabled||a)return!1;var a=!0,b=[];a=jQuery("#pos_modals .modal");jQuery.each(a,function(a,d){var c=jQuery(this).find(".position_data"),e=c.data("sell-order-placed"),k=c.data("trailing-only"),g=c.data("id"),h=c.data("pair");if(""!=jQuery.trim(jQuery("#pos_sell_order_id_"+g).val())&&0<jQuery.trim(jQuery("#pos_sell_order_id_"+g).val()).length||jQuery("#hold_position_"+g).prop("checked")||!(h in current_rates.ticker)||
!("highestBid"in current_rates.ticker[h]))return!0;h=getCorrectRateToUse(current_rates.ticker[h],"highestBid");h=parseFloat(h);if(!h||0>=h)return!0;var l=!1;if(g in previous_position_rates){if(l=previous_position_rates[g],h==previous_position_rates[g])return!0}else previous_position_rates[g]=h;var n=Math.floor(Date.now()/1E3);if(g in last_position_checks&&10>n-last_position_checks[g])return!0;var m=c.data("rate");m=parseFloat(m);var q=jQuery(this).find(".percentageProfitField").val();var p=((h-m)/
m*100).toFixed(2);if(1!=k&&0==e&&0<m&&0<h&&(!l||0<l&&l<h)&&parseFloat(p)>=parseFloat(q))return b.push(g),last_position_checks[g]=n,!0;if(!l||0<l&&l>h)if(e=c.data("stop-loss-this"),k=parseFloat(c.data("stop-loss-rate")),1==e&&0<k&&h<=k&&0<h)return b.push(g),last_position_checks[g]=n,!0;e=c.data("auto-close-this");k=parseFloat(c.data("auto-close-time"));m=parseFloat(c.data("time"));if(1==e&&0<k&&m<k)return b.push(g),last_position_checks[g]=n,!0;e=c.data("trailing");k=c.data("trailing-arm");m=parseFloat(c.data("stop-loss"));
c=parseFloat(c.data("trailing-percentage"));if(e)if(0<m){if(h<=m||(!l||0<l&&l<h)&&(h-m)/m*100>c)return b.push(g),last_position_checks[g]=n,!0}else if((!l||0<l&&l<h)&&parseFloat(p)>=k)return b.push(g),last_position_checks[g]=n,!0});1<b.length?jQuery.ajax({url:"/siteapi.php?todo=checkpositions",cache:!1}).done(function(a){}):1==b.length&&jQuery.ajax({url:"/siteapi.php?todo=checkpositions&single="+b[0],cache:!1}).done(function(a){});a=!1}
function showRates(a){current_rates=a;var b=jQuery("#datatable-responsive tbody tr"),c=jQuery("#pos_modals .modal"),d=jQuery("#openorders_div");jQuery.each(a.ticker,function(a,e){var f=a;a=a.replace("/","_");jQuery.each(b,function(b,c){var d=jQuery(this).find(".old_rate_"+a);if(0<d.length&&0<e.highestBid){d=parseFloat(d.text());e.highestBid=parseFloat(e.highestBid);e.last=parseFloat(e.last);var g=getCorrectRateToUse(e,"highestBid"),f=((g-d)/d*100).toFixed(2)+"%";g>=d?(jQuery(this).find(".rate_"+a).removeClass("text-danger").addClass("text-success").text(f),
jQuery(this).find(".sellButton").removeClass("btn-danger").addClass("btn-success")):(jQuery(this).find(".rate_"+a).addClass("text-danger").removeClass("text-success").text(f),jQuery(this).find(".sellButton").addClass("btn-danger").removeClass("btn-success"))}});jQuery.each(c,function(b,c){var d=jQuery(this).find(".old_rate_"+a);if(0<d.length&&0<e.highestBid){d=parseFloat(d.text());e.highestBid=parseFloat(e.highestBid);e.last=parseFloat(e.last);var g=getCorrectRateToUse(e,"highestBid");var f=((g-d)/
d*100).toFixed(2);var h=g.toFixed(8);f+="%";g>=d?(jQuery(this).find(".rate_"+a).removeClass("text-danger").addClass("text-success").text(f),jQuery(this).find(".current_rate_"+a).removeClass("text-danger").addClass("text-success").text(h),jQuery(this).find(".sellButton").removeClass("btn-danger").addClass("btn-success")):(jQuery(this).find(".rate_"+a).addClass("text-danger").removeClass("text-success").text(f),jQuery(this).find(".current_rate_"+a).addClass("text-danger").removeClass("text-success").text(h),
jQuery(this).find(".sellButton").addClass("btn-danger").removeClass("btn-success"))}});jQuery.each(d,function(b,c){if(0<e.highestBid){e.highestBid=parseFloat(e.highestBid);e.last=parseFloat(e.last);var d=getCorrectRateToUse(e,"highestBid").toFixed(8);jQuery(this).find(".current_rate_"+a).text(d)}});jQuery("#manual_buy_target").val()==f&&0<e.lowestAsk&&(jQuery("#fill_buy_price_lowest").text(e.lowestAsk),jQuery("#fill_buy_price_last").text(e.last),jQuery(".manual_buy_rates").show(),1===set_buy_rate&&
(jQuery("#manual_buy_price").val(e.lowestAsk),calcBuyRates("manual_buy_price")),set_buy_rate=0)});do_not_ajax_now=!0;a=$("#datatable-responsive tbody tr");open_pos_table&&open_pos_table.rows(a).invalidate().draw(!1);setTimeout(function(){do_not_ajax_now=!1},200)}function refreshRates(){jQuery.ajax({url:"/siteapi.php?todo=refreshrates",cache:!1}).done(function(a){1==a.status&&showRates(a)})}
Number.prototype.toTotallyFixed=function(a){var b=this.toString(),c=(b+(-1!=b.indexOf(".")?"":".0")).split(".");return c[0].length>a?b.slice(0,a):c[0]+(+("."+c[1])).toFixed(a-(c[0].length-1)).slice(1)};function createPercentageProfitFields(){jQuery(".percentageProfitField").TouchSpin({min:0,max:9999,step:.1,decimals:2,boostat:5,maxboostedstep:10,buttondown_class:"btn btn-primary",buttonup_class:"btn btn-primary",postfix:"%"})}
function selectAllBulkChecks(a){a?jQuery(".selectAllBulk:visible").prop("checked",!0):jQuery(".selectAllBulk:visible").prop("checked",!1)}
function enableDisableHopperStatus(a){1==a?(jQuery("#switch_enable_hopper_div i").removeClass("text-danger").addClass("text-success"),jQuery("#switch_enable_hopper_div p").removeClass("text-danger").addClass("text-success"),jQuery("#switch_enable_hopper_div p").html("Hopper is <strong>enabled</strong>"),jQuery("#hopper_current_status").html('<span class="text-success"><i class="fa fa-check-circle-o m-r-5"></i> Hopper is enabled</span>'),enableDisableWalletScrubber(1)):(jQuery("#switch_enable_hopper_div i").removeClass("text-success").addClass("text-danger"),
jQuery("#switch_enable_hopper_div p").removeClass("text-success").addClass("text-danger"),jQuery("#switch_enable_hopper_div p").html("Hopper is <strong>disabled</strong>"),jQuery("#hopper_current_status").html('<span class="text-danger"><i class="fa fa-circle-o m-r-5"></i> Hopper is disabled</span>'),enableDisableWalletScrubber(0))}
function enableDisableBuyingStatus(a){0==a?(jQuery("#switch_enable_buying_div i").removeClass("text-danger").addClass("text-success"),jQuery("#switch_enable_buying_div p").removeClass("text-danger").addClass("text-success"),jQuery("#switch_enable_buying_div p").html("Buying is <strong>enabled</strong>")):(jQuery("#switch_enable_buying_div i").removeClass("text-success").addClass("text-danger"),jQuery("#switch_enable_buying_div p").removeClass("text-success").addClass("text-danger"),jQuery("#switch_enable_buying_div p").html("Buying is <strong>disabled</strong>"))}
function enableDisableSellingStatus(a){0==a?(jQuery("#switch_enable_selling_div i").removeClass("text-danger").addClass("text-success"),jQuery("#switch_enable_selling_div p").removeClass("text-danger").addClass("text-success"),jQuery("#switch_enable_selling_div p").html("Selling is <strong>enabled</strong>")):(jQuery("#switch_enable_selling_div i").removeClass("text-success").addClass("text-danger"),jQuery("#switch_enable_selling_div p").removeClass("text-success").addClass("text-danger"),jQuery("#switch_enable_selling_div p").html("Selling is <strong>disabled</strong>"))}
jQuery(document).ready(function(a){loadAutosyncAllowedCoinsSelect();setInterval(function(){track_hopper_run_time&&60<Math.floor(Date.now()/1E3)-track_hopper_run_time&&checkHopperRunning();doubleCheckOpenOrders()},3E4);1!=hopper_running&&1==hopper_enabled&&startNextRunTimer();createPercentageProfitFields();jQuery("#refreshOrdersButton").click(function(a){refreshOrdersOnly()});jQuery("#refreshPosButton").click(function(a){refreshPositionsAndOrders()});jQuery("#refreshSummaryButton").click(function(a){refreshPositionSummary()});
jQuery("#selectAllBulkSelection").live("change",function(a){selectAllBulkChecks(this.checked)});jQuery("#manual_buy_trailing").change(function(){this.checked?jQuery("#manual_buy_trailing_div").show():jQuery("#manual_buy_trailing_div").hide()});jQuery("#switch_enable_hopper").change(function(){if(donot_switch_enable_hopper)return!0;var a=0;this.checked&&(a=1);enableDisableHopperStatus(a);jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=enablehopper",data:{enable:a,hopper_id:jQuery("#active_hopper_id").val()},
cache:!1,beforeSend:function(){},complete:function(){},success:function(b){1==b.status?(hopper_enabled=a,1==a?startNextRunTimer():hideNextRunTimer()):(donot_switch_enable_hopper=!0,1==a?(jQuery("#switch_enable_hopper").prop("checked",!1),jQuery("#switch_enable_hopper_div i").removeClass("text-success").addClass("text-danger"),jQuery("#switch_enable_hopper_div p").removeClass("text-success").addClass("text-danger"),jQuery("#switch_enable_hopper_div p").html("Hopper is <strong>disabled</strong>"),jQuery("#hopper_current_status").html('<span class="text-danger"><i class="fa fa-circle-o m-r-5"></i> Hopper is disabled</span>'),
enableDisableWalletScrubber(0)):(jQuery("#switch_enable_hopper").prop("checked",!0),jQuery("#switch_enable_hopper_div i").removeClass("text-danger").addClass("text-success"),jQuery("#switch_enable_hopper_div p").removeClass("text-danger").addClass("text-success"),jQuery("#switch_enable_hopper_div p").html("Hopper is <strong>enabled</strong>"),jQuery("#hopper_current_status").html('<span class="text-success"><i class="fa fa-check-circle-o m-r-5"></i> Hopper is enabled</span>'),enableDisableWalletScrubber(1)),
swal({title:b.error,text:"There was an error enabling the hopper.",type:"error"}),donot_switch_enable_hopper=!1)}})});jQuery("#autosync").change(function(){setTimeout(setAutoSync,300)});jQuery("#autosync_all_coins").change(function(){setTimeout(setAutoSyncAllCoins,300)});jQuery("#autosync_allowed_coins").change(function(){setTimeout(setAutoSyncAllowedCoins,300)});jQuery("#switch_enable_buying").change(function(){if(donot_switch_enable_buying)return!0;var a=1;this.checked&&(a=0);enableDisableBuyingStatus(a);
jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=enablebuying",data:{enable:a,hopper_id:jQuery("#active_hopper_id").val()},cache:!1,beforeSend:function(){},complete:function(){},success:function(b){1!=b.status&&(donot_switch_enable_buying=!0,1==a?(jQuery("#switch_enable_buying").prop("checked",!1),jQuery("#switch_enable_buying_div i").removeClass("text-success").addClass("text-danger"),jQuery("#switch_enable_buying_div p").removeClass("text-success").addClass("text-danger"),jQuery("#switch_enable_buying_div p").html("Buying is <strong>disabled</strong>")):
(jQuery("#switch_enable_buying").prop("checked",!0),jQuery("#switch_enable_buying_div i").removeClass("text-danger").addClass("text-success"),jQuery("#switch_enable_buying_div p").removeClass("text-danger").addClass("text-success"),jQuery("#switch_enable_buying_div p").html("Buying is <strong>enabled</strong>")),swal({title:b.error,text:"There was an error enabling/disabling buying.",type:"error"}),donot_switch_enable_buying=!1)}})});jQuery("#switch_enable_selling").change(function(){if(donot_switch_enable_selling)return!0;
var a=1;this.checked&&(a=0);enableDisableSellingStatus(a);jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=enableselling",data:{enable:a,hopper_id:jQuery("#active_hopper_id").val()},cache:!1,beforeSend:function(){},complete:function(){},success:function(b){1==b.status?selling_enabled=1==a?0:1:(donot_switch_enable_selling=!0,1==a?(jQuery("#switch_enable_selling").prop("checked",!1),jQuery("#switch_enable_selling_div i").removeClass("text-success").addClass("text-danger"),jQuery("#switch_enable_selling_div p").removeClass("text-success").addClass("text-danger"),
jQuery("#switch_enable_selling_div p").html("Selling is <strong>disabled</strong>")):(jQuery("#switch_enable_selling").prop("checked",!0),jQuery("#switch_enable_selling_div i").removeClass("text-danger").addClass("text-success"),jQuery("#switch_enable_selling_div p").removeClass("text-danger").addClass("text-success"),jQuery("#switch_enable_selling_div p").html("Selling is <strong>enabled</strong>")),swal({title:b.error,text:"There was an error enabling/disabling selling.",type:"error"}),donot_switch_enable_selling=
!1)}})});jQuery("#autorefreshCheckbox").change(function(){jQuery.ajax({url:"/siteapi.php?todo=autorefresh&check="+(this.checked?1:0),cache:!1}).done(function(a){})});jQuery("#walletscrubber_leftovers").change(function(){jQuery.ajax({url:"/siteapi.php?todo=walletscrubberleft&check="+(this.checked?1:0),cache:!1}).done(function(a){})});jQuery("#walletscrubber_auto").change(function(){var a=this.checked?1:0;jQuery.ajax({url:"/siteapi.php?todo=walletscrubberauto&check="+a,cache:!1}).done(function(b){1==
a?(walletscrubber_auto=1,jQuery(".scrubWallets").hide()):(walletscrubber_auto=0,jQuery(".scrubWallets").show());jQuery(".scrubstartedbutton").hide()})});jQuery("#walletscrubber_noopen").change(function(){jQuery.ajax({url:"/siteapi.php?todo=walletscrubbernoopen&check="+(this.checked?1:0),cache:!1}).done(function(a){})});jQuery("#total_allowed_buy").click(function(){fillBuyAmount(!1)});jQuery("#panic-button").click(function(){swal({title:"Are you sure?",text:"All positions will be sold immediately and the cryptohopper will be stopped! Please be patient as selling all positions could take a few seconds. (This is done best when the hopper is not running)",
type:"warning",showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"Yes, sell everything"}).then(function(a){if(!a.value)return!1;panicButton()})});1!=live_hopper&&checkHopperRunning();setInterval(checkHopperRunning,3E5);jQuery(document.body).on("change","#manual_buy_target",function(){loadBuyRates()});setTimeout(function(){initShowBuyAllCoins()},300);jQuery(window).focus(function(){check_rates=!0});jQuery(window).blur(function(){check_rates=!1});setTimeout(function(){getSavedDivStatus("summary");
getSavedDivStatus("openorders");getSavedDivStatus("manualbuy");getSavedDivStatus("manualtarget");getSavedDivStatus("currentassets");getSavedDivStatus("systemmessages");getSavedDivStatus("hopperoutput-log");getSavedDivStatus("hoppersignaloutput-log")},400);setTimeout(getCurrentHopperOutputLog,800);a=Cookies.get("dash_hopperoutput-log_hide");if(live_hopper&&(!a||0==a)){a=moment().subtract(3,"hours");var b=moment();jQuery(".input-daterange-timepicker").daterangepicker({startDate:a,endDate:b,timePicker:!0,
format:"MM/DD/YYYY h:mm A",timePickerIncrement:1,timePicker12Hour:!0,timePickerSeconds:!1,buttonClasses:["btn","btn-sm"],applyClass:"btn-default",cancelClass:"btn-primary"});setTimeout(function(){output_daterange_init=!0},100)}setInterval(checkAgeTimes,1E4)});
function panicButton(){jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=panicbutton",data:{},cache:!1,beforeSend:function(){jQuery("#panic-button").html('<i class="fa fa-refresh fa-spin m-r-5" style="font-size:inherit"></i> Panic mode activated')},complete:function(){setTimeout(function(){jQuery("#panic-button").html("Panic Button")},1E4)},success:function(a){1==a.status?(jQuery("#panic-button").html('<i class="fa fa-refresh fa-spin m-r-5" style="font-size:inherit"></i> Panic mode completed'),
swal({title:"Panic Sell",text:"Sell orders will be placed for all your positions.",timer:3E3,type:"success"}),jQuery("#switch_enable_hopper").prop("checked",!1),jQuery("#switch_enable_hopper_div i").removeClass("text-success").addClass("text-danger"),jQuery("#switch_enable_hopper_div p").removeClass("text-success").addClass("text-danger"),jQuery("#switch_enable_hopper_div p").html("Hopper is <strong>disabled</strong>"),jQuery("#hopper_current_status").html('<span class="text-danger"><i class="fa fa-circle-o m-r-5"></i> Hopper is disabled</span>'),
fireEventSwitchery("switch_enable_hopper")):swal({title:"Something went wrong",text:"Something went wrong when trying to panic sell your positions. Error message: "+a.error,type:"error"})}})}
function setTimeFrame(a){if(!current_coin&&!current_market)return!1;jQuery(".periodButton").removeClass("btn-primary").addClass("btn-default");jQuery(".periodButton-"+a).removeClass("btn-default").addClass("btn-primary");current_period=a;loadIframe(current_market,current_coin,current_rate,current_time,current_tp_rate,current_stop_loss_rate)}function fillBuyPrice(a){jQuery("#manual_buy_price").val(jQuery("#"+a).text());calcBuyRates("manual_buy_price")}
function loadBuyRates(){0!=jQuery("#manual_buy_target option:selected").val()&&(set_buy_rate=1,reloadRates(),jQuery(".manual_buy_coin").text(buy_pairs_to_coin[jQuery("#manual_buy_target option:selected").val()]))}function fillBuyAmount(a){a||(a=total_allowed_buy);jQuery("#manual_buy_total").val(a);calcBuyRates("manual_buy_total")}
function holdPositionSwitch(a){if(1==hopper_running||action_from_bulk)return!1;var b=0;jQuery("#hold_position_"+a).prop("checked")&&(b=1);jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=saveholdopenorder",data:{hold:b,pos_i:a},cache:!1,beforeSend:function(){},complete:function(){},success:function(c){1!=c.status&&(1==b?jQuery("#hold_position_"+a).prop("checked",!1):jQuery("#hold_position_"+a).prop("checked",!0),swal({title:"Something went wrong",text:"Something went wrong trying to hold position. Error message: "+
c.error,type:"error"}))}})}
function setPercentageProfit(a){if(1==hopper_running)return!1;jQuery("#save_percentage_profit_"+a).html('<i class="fa fa-cog fa-spin fa-fw"></i>');jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=saveppopenorder",data:{percentage:jQuery("#percentage_profit_"+a).val(),pos_i:a},cache:!1,beforeSend:function(){},complete:function(){},success:function(b){1==b.status?(jQuery("#save_percentage_profit_"+a).html("Saved!"),setTimeout(function(){jQuery("#save_percentage_profit_"+a).html("Save")},
4E3)):swal({title:"Something went wrong",text:"Something went wrong trying to set the percentage profit. Error message: "+b.error,type:"error"})}})}
function calcBuyRates(a){if("manual_buy_total"==a){if(""!==jQuery("#manual_buy_price").val()){var b=parseFloat(jQuery("#manual_buy_total").val());a=parseFloat(jQuery("#manual_buy_price").val());a=(b/a).toFixed(8);jQuery("#manual_buy_amount").val(a)}}else"manual_buy_amount"==a?""!==jQuery("#manual_buy_price").val()&&(b=parseFloat(jQuery("#manual_buy_amount").val()),a=parseFloat(jQuery("#manual_buy_price").val()),a=(b*a).toFixed(8),jQuery("#manual_buy_total").val(a)):"manual_buy_price"==a&&""!==jQuery("#manual_buy_price").val()&&
""!==jQuery("#manual_buy_total").val()&&(b=parseFloat(jQuery("#manual_buy_total").val()),a=parseFloat(jQuery("#manual_buy_price").val()),a=(b/a).toFixed(8),jQuery("#manual_buy_amount").val(a),calcBuyPercentageProfit("manual_buy_price"))}
function loadIframe(a,b,c,d,f,e){current_market=a;current_coin=b;current_rate=c;current_time=d;current_tp_rate=f;current_stop_loss_rate=e;jQuery(".iframe_coinname").text(b);"tradingview"==use_chart_type?document.getElementById("chart_iframe").src="/chart/chart_tradingview.php?market="+a+"&period="+current_period+"&buy_rate="+c+"&buy_time="+d+"&tp_rate="+current_tp_rate+"&sl_rate="+current_stop_loss_rate+"&exchange="+cur_exchange:document.getElementById("chart_iframe").src="/chart/chart.php?market="+
a+"&period="+current_period+"&buy_rate="+c+"&buy_time="+d+"&tp_rate="+current_tp_rate+"&sl_rate="+current_stop_loss_rate+"&exchange="+cur_exchange}function getSavedPageLength(){var a=Cookies.get("dash_length");return a?a:50}
function getSavedDivStatus(a){var b=Cookies.get("dash_"+a);!b&&0!==b||1==b?(jQuery("#"+a).addClass("in").prop("aria-expanded","true"),jQuery("#"+a+"-button").prop("aria-expanded","true").removeClass("collapsed")):(jQuery("#"+a).removeClass("in").prop("aria-expanded","false").css("height","0px"),jQuery("#"+a+"-button").addClass("collapsed").prop("aria-expanded","false"))}
function removeDivcollapse(a){Cookies.set("dash_"+a+"_hide",1,{path:"/",secure:!0,expires:365});jQuery("#viewDash"+a+"Button i").removeClass("fa-check-square-o").addClass("fa-square-o")}function showDashDiv(a){Cookies.set("dash_"+a+"_hide",0,{path:"/",secure:!0,expires:365});Cookies.set("dash_"+a,1,{path:"/",secure:!0,expires:365});location.reload()}
function divCollapse(a){setTimeout(function(){jQuery("#"+a).hasClass("in")?("summary"==a&&refreshPositionSummary(),Cookies.set("dash_"+a,1,{path:"/",secure:!0,expires:365})):Cookies.set("dash_"+a,0,{path:"/",secure:!0,expires:365})},500)}
function showHideDiv(a){var b=Cookies.get("dash_"+a+"_hide");b&&0!=b?1==b&&(Cookies.set("dash_"+a+"_hide",0,{path:"/",secure:!0,expires:365}),Cookies.set("dash_"+a,1,{path:"/",secure:!0,expires:365}),jQuery("#viewDash"+a+"Button i").addClass("fa-refresh fa-spin").removeClass("fa-square-o"),location.reload()):(jQuery("#viewAllHiddenDiv").show(),jQuery("#removeDiv-"+a).click())}
function loadBuyCoins(a,b){jQuery("select#"+a).select2("destroy");jQuery("#"+a+" option").remove();jQuery("#"+a).append('<option value="not_selected" disabled selected class="allowed">Select a coin</option>');jQuery.each(all_pairs,function(c,d){(b&&-1<allowed_pairs.indexOf(c)||!b)&&jQuery("#"+a).append('<option value="'+c+'">'+d+"</option>")});jQuery("select#"+a).select2()}
function showBuyAllCoins(){1==Cookies.get("dash_buy_allowed_coins")?(Cookies.set("dash_buy_allowed_coins",0,{path:"/",secure:!0,expires:365}),loadBuyCoins("manual_buy_target",!1),jQuery("#manualbuyshowall").text("Show allowed only")):(Cookies.set("dash_buy_allowed_coins",1,{path:"/",secure:!0,expires:365}),loadBuyCoins("manual_buy_target",1),jQuery("#manualbuyshowall").text("Show all"))}
function initShowBuyAllCoins(){1==Cookies.get("dash_buy_allowed_coins")?(loadBuyCoins("manual_buy_target",1),jQuery("#manualbuyshowall").text("Show all")):(loadBuyCoins("manual_buy_target",!1),jQuery("#manualbuyshowall").text("Show allowed only"))}
function showAllHiddenDivs(){jQuery.each("summary openorders manualbuy manualtarget currentassets systemmessages hopperoutput-log hoppersignaloutput-log".split(" "),function(a,b){Cookies.set("dash_"+b+"_hide",0,{path:"/",secure:!0,expires:365});Cookies.set("dash_"+b,1,{path:"/",secure:!0,expires:365});jQuery("#viewDash"+b+"Button i").removeClass("fa-square-o fa-check-square-o").addClass("fa-refresh fa-spin")});location.reload()}
function getSavedOrdering(){var a=Cookies.get("dash_order_col"),b=Cookies.get("dash_order_type");return 0<=a&&b?[a,b]:[0,"asc"]}
function calcBuyPercentageProfit(a){var b=parseFloat(jQuery("#manual_buy_price").val()),c=parseFloat(jQuery("#manual_buy_sellprice").val()),d=parseFloat(jQuery("#manual_buy_percentageprofit").val());if(!b||0>=b)return!1;"manual_buy_percentageprofit"==a?0<d?(a=b*(1+d/100),jQuery("#manual_buy_sellprice").val(a.toFixed(8))):jQuery("#manual_buy_sellprice").val(""):"manual_buy_sellprice"==a?0<c?(c<b&&(c=b),a=c/b*100-100,0<a?jQuery("#manual_buy_percentageprofit").val(a.toFixed(2)):jQuery("#manual_buy_percentageprofit").val("")):
jQuery("#manual_buy_percentageprofit").val(""):0<d&&(a=b*(1+d/100),jQuery("#manual_buy_sellprice").val(a.toFixed(8)))}
function saveBuyOrder(){jQuery("#buy_modal_confirm").modal("toggle");var a=0;jQuery("#manual_buy_trailing").prop("checked")&&0<parseFloat(jQuery("#manual_buy_trailing_percentage").val())&&(a=1);jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=manualbuy",data:{manual_buy_price:jQuery("#manual_buy_price").val(),manual_buy_target:jQuery("#manual_buy_target").val(),manual_buy_amount:jQuery("#manual_buy_amount").val(),manual_buy_total:jQuery("#manual_buy_total").val(),manual_buy_trailing:a,
manual_buy_trailing_percentage:jQuery("#manual_buy_trailing_percentage").val(),manual_buy_percentageprofit:jQuery("#manual_buy_percentageprofit").val()},cache:!1,beforeSend:function(){jQuery("#placingBuyOrderButton").html('<i class="fa fa-refresh fa-spin" style="font-size:inherit"></i> Placing buy order');jQuery("#confirmBuyOrder").html('<i class="fa fa-refresh fa-spin" style="font-size:inherit"></i> Placing buy order')},complete:function(){jQuery("#placingBuyOrderButton").html("Place buy order");
jQuery("#confirmBuyOrder").html("Confirm order")},success:function(a){1==a.status?1==live_hopper?show_buy_success_message=!0:swal({title:"Buy order placed",text:a.message,timer:3E3,type:"success"}):swal({title:"Error",text:a.error,type:"error"})}})}
function manualTargetRemoved(){jQuery("#manual_target option").prop("selected",!1);jQuery('#manual_target option[value="0"]').prop("selected",!0);jQuery("#removeManualTarget").html('<i class="fa fa-check" style="font-size:inherit;margin: 2px 5px 0 0;"></i> Manual target removed.');setTimeout(function(){jQuery("#removeManualTarget").hide().html("Remove manual target")},3E3)}
function removeManualTarget(){jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=removemanualtarget",data:{},cache:!1,beforeSend:function(){jQuery("#removeManualTarget").html('<i class="fa fa-refresh fa-spin" style="font-size:inherit;margin: 2px 5px 0 0;"></i> Removing target')},complete:function(){},success:function(a){1==a.status?manualTargetRemoved():(swal({title:"Error",text:a.error,type:"error"}),jQuery("#removeManualTarget").html("Remove manual target"))}})}
function removeCurrentTarget(){jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=removecurrenttarget",data:{},cache:!1,beforeSend:function(){jQuery("#removeCurrentTarget").html('<i class="fa fa-refresh fa-spin" style="font-size:inherit;margin: 4px 5px 0 0;"></i> Removing')},complete:function(){},success:function(a){1==a.status?(jQuery("#removeCurrentTarget").html('<i class="fa fa-check" style="font-size:inherit;margin: 4px 5px 0 0;"></i> Removed'),setTimeout(function(){jQuery("#removeCurrentTarget").html('<i class="fa fa-times fa-fw" style="font-size:inherit;margin: 4px 5px 0 0;"></i> Remove');
jQuery("#removeCurrentTarget").hide()},3E3)):(swal({title:"Error",text:a.error,type:"error"}),jQuery("#removeCurrentTarget").html('<i class="fa fa-times fa-fw" style="font-size:inherit;margin: 4px 5px 0 0;i></i> Remove'))}})}
function validateCurrentTargetTime(){var a=getCurrentManualTargetTime();jQuery("#manual_target_time_count").val(a.time_count);Cookies.set("dash_mt_time_count",a.time_count,{path:"/",secure:!0,expires:365});Cookies.set("dash_mt_time_val",a.time_val,{path:"/",secure:!0,expires:365})}
function getCurrentManualTargetTime(){var a={};a.time_count=parseInt(jQuery("#manual_target_time_count").val());a.time_val=jQuery("#manual_target_time_val option:selected").val();0>=a.time_count&&(a.time_count=1);"hours"!=a.time_val&&"seconds"!=a.time_val&&(a.time_val="minutes");99<a.time_count&&"hours"==a.time_val&&(a.time_count=99);999<a.time_count&&(a.time_count=999);30>a.time_count&&"seconds"==a.time_val&&(a.time_count=30);return a}
function saveManualTarget(){var a=getCurrentManualTargetTime();jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=manualtarget",data:{manual_target:jQuery("#manual_target option:selected").val(),time_count:a.time_count,time_val:a.time_val},cache:!1,beforeSend:function(){jQuery("#set_manual_target").html('<i class="fa fa-refresh fa-spin" style="font-size:inherit;margin:4px 0 3px 0;"></i>')},complete:function(){jQuery("#set_manual_target").html("Target")},success:function(a){1==a.status?
(swal({title:"Manual target set",text:a.message,timer:3E3,type:"success"}),jQuery("#removeManualTarget").show()):swal({title:"Error",text:a.error,type:"error"})}})}
function placeBuyOrder(){var a=jQuery("#total_allowed_buy").text();if("not_selected"===jQuery("#manual_buy_target option:selected").val())return swal({title:"No target selected",text:"You did not select a target coin to buy. Please select a coin first.",type:"error"}),jQuery("#manual_buy_target").focus(),!1;if(""==jQuery("#manual_buy_price").val())return swal({title:"No price",text:"Price cannot be empty. Please enter a price for your buy order.",type:"error"}),jQuery("#manual_buy_amount").focus(),
!1;if(""==jQuery("#manual_buy_amount").val())return swal({title:"No amount",text:"Amount cannot be empty. Please enter an amount for your buy order.",type:"error"}),jQuery("#manual_buy_amount").focus(),!1;if(""==jQuery("#manual_buy_total").val())return swal({title:"No total",text:"You did not enter the a total for your buy order. Please enter a total.",type:"error"}),jQuery("#manual_buy_total").focus(),!1;if(parseFloat(jQuery("#manual_buy_total").val())>parseFloat(a))return swal({title:"Not enough funds",
text:"You do not have enough "+collect_currency+" to place this buy order. Please adjust your buy order.",type:"error"}),!1;jQuery("#mb_confirm_pp").hide();jQuery("#mb_confirm_tb").hide();jQuery("#manual_buy_trailing").prop("checked")&&0<parseFloat(jQuery("#manual_buy_trailing_percentage").val())&&(jQuery("#mb_confirm_tb").show(),a=parseFloat(jQuery("#manual_buy_trailing_percentage").val()),jQuery("#buy_confirm_trailing_buy").text("Enabled ("+percentage_format(a)+"%)"));a=parseFloat(jQuery("#manual_buy_sellprice").val());
var b=parseFloat(jQuery("#manual_buy_percentageprofit").val());0<b&&""==a?(calcBuyPercentageProfit("manual_buy_percentageprofit"),jQuery("#buy_confirm_sellprice").text(jQuery("#manual_buy_sellprice").val()),jQuery("#buy_confirm_percentageprofit").text(b),jQuery("#mb_confirm_pp").show()):0<a&&""==b?(calcBuyPercentageProfit("manual_buy_sellprice"),jQuery("#buy_confirm_sellprice").text(a),jQuery("#buy_confirm_percentageprofit").text(jQuery("#manual_buy_percentageprofit").val()),jQuery("#mb_confirm_pp").hide()):
0<a&&0<b&&(jQuery("#buy_confirm_sellprice").text(a),jQuery("#buy_confirm_percentageprofit").text(b),jQuery("#mb_confirm_pp").show());jQuery("#buy_confirm_price").text(jQuery("#manual_buy_price").val());jQuery("#buy_confirm_amount").text(jQuery("#manual_buy_amount").val());jQuery("#buy_confirm_total").text(jQuery("#manual_buy_total").val());jQuery("#buy_modal_confirm").modal("show")}
function plotAssetsSummary(a,b,c,d,f,e,k){jQuery("#current-assets").empty();per_cur_totals=b;other_coins=c;jQuery.plot("#current-assets",a,{series:{pie:{show:!0,combine:{color:"#CCC",threshold:.06,label:"Other"}}},legend:{show:!1},grid:{hoverable:!0,clickable:!0},colors:"#FFAA00 #3BAFDA #F76397 #00B19D #3DDCF7 #797979 #7266BA #EF5350 #DCDCDC #6DC7D2 #4C5667 #B11410 #007D6D #FFEECC #777777 #52459A".split(" ")});jQuery("#summary_text_costs").text(d);jQuery("#summary_text_percs").text(f+"%");0>parseFloat(f)?
jQuery("#summary_text_percs").removeClass("text-success").addClass("text-danger"):jQuery("#summary_text_percs").removeClass("text-danger").addClass("text-success");jQuery("#summary_text_holds").text(e);jQuery("#summary_text_poss").text(k);jQuery("#current-assets").bind("plothover",function(a,b,c){if(do_not_change_stats)return!0;c?(a=c.series.label.toUpperCase(),"OTHER"==a?(b=other_coins.join("|"),open_pos_table.column(2).search(b,!0,!1).draw(),jQuery("#summary_total_title").text("Totals other coins"),
jQuery("#filtered_text_stats").text("These are your current open positions in other coins.")):(open_pos_table.column(2).search(a).draw(),jQuery("#summary_total_title").text("Totals "+a),jQuery("#filtered_text_stats").text("These are your current open positions in "+a+".")),jQuery("#summary_text_costs").text(per_cur_totals[a].costs),jQuery("#summary_text_percs").text(per_cur_totals[a].percs+"%"),0>per_cur_totals[a].percs?jQuery("#summary_text_percs").removeClass("text-success").addClass("text-danger"):
jQuery("#summary_text_percs").removeClass("text-danger").addClass("text-success"),jQuery("#summary_text_holds").text(per_cur_totals[a].holds),jQuery("#summary_text_poss").text(per_cur_totals[a].poss)):(open_pos_table.column(2).search("").draw(),jQuery("#filtered_text_stats").text("These are your current open positions."),jQuery("#summary_total_title").text("Totals current positions"),jQuery("#summary_text_costs").text(d),jQuery("#summary_text_percs").text(f+"%"),0>parseFloat(f)?jQuery("#summary_text_percs").removeClass("text-success").addClass("text-danger"):
jQuery("#summary_text_percs").removeClass("text-danger").addClass("text-success"),jQuery("#summary_text_holds").text(e),jQuery("#summary_text_poss").text(k))});jQuery("#current-assets").bind("plotclick",function(a,b,c){c&&(do_not_change_stats=!0,a=c.series.label.toUpperCase(),showOnlyCoinRows(a))})}
function showOnlyCoinRows(a){assets_only_show_coin=a;if("OTHER"==a){var b=other_coins.join("|");open_pos_table.column(2).search(b,!0,!1).draw();jQuery("#summary_total_title").text("Totals other coins");jQuery("#filtered_text_stats").text("These are your current open positions in other coins.")}else open_pos_table.column(2).search(a).draw(),jQuery("#summary_total_title").text("Totals "+a),jQuery("#filtered_text_stats").text("These are your current open positions in "+a+".");jQuery("#summary_text_costs").text(per_cur_totals[a].costs);
jQuery("#summary_text_percs").text(per_cur_totals[a].percs+"%");0>per_cur_totals[a].percs?jQuery("#summary_text_percs").removeClass("text-success").addClass("text-danger"):jQuery("#summary_text_percs").removeClass("text-danger").addClass("text-success");jQuery("#summary_text_holds").text(per_cur_totals[a].holds);jQuery("#summary_text_poss").text(per_cur_totals[a].poss);jQuery("#remove_stats_filter").show()}function toggleTaValues(a,b){jQuery("#"+a+"_"+b).toggle()}
function hideNextRunTimer(){if(1==live_hopper)return!1;nextRunInterval&&(clearInterval(nextRunInterval),nextRunInterval=!1);jQuery("#nextRunDate").removeClass("text-danger");jQuery("#nextRunDiv").hide()}
function startNextRunTimer(){if(1==live_hopper)return!1;nextRunInterval&&(clearInterval(nextRunInterval),nextRunInterval=!1);if(!hopper_enabled)return!1;nextRunIntervalDiv?jQuery("#nextRunDiv").show():(jQuery("#lastRunDiv").append(' | <span id="nextRunDiv">Next run: <br class="visible-xs"><strong id="nextRunDate"></strong></span>'),nextRunIntervalDiv=!0);(new Date(hopper_last_run)).getTime();parseInt(hopper_interval);nextRunInterval=setInterval(function(){(new Date).getTime();var a=1E3*hopper_sec_left;
hopper_sec_left--;var b=Math.floor(a%36E5/6E4),c=Math.floor(a%6E4/1E3);0<b?document.getElementById("nextRunDate").innerHTML=b+" min "+c+" sec":1==c?document.getElementById("nextRunDate").innerHTML=c+" second":document.getElementById("nextRunDate").innerHTML=c+" seconds";10>=c&&0==b?jQuery("#nextRunDate").addClass("text-danger"):jQuery("#nextRunDate").removeClass("text-danger");0>a&&(clearInterval(nextRunInterval),nextRunInterval=!1,document.getElementById("nextRunDate").innerHTML="Any moment",jQuery("#nextRunDate").addClass("text-danger"))},
1E3)}
function checkAgeTimes(){var a=jQuery("#pos_modals .modal"),b=(new Date).getTime(),c=0;jQuery.each(a,function(a,f){var d=jQuery(this).find(".position_data"),k=d.data("time");d=d.data("id");c=b-1E3*k;k=calcTimeAgo(c);jQuery(".open_position_age_"+d).text(k)});a=jQuery("#datatable-responsive tbody tr");open_pos_table&&open_pos_table.rows(a).invalidate().draw(!1);a=jQuery("#openorders_modals .modal");b=(new Date).getTime();c=0;jQuery.each(a,function(a,f){var d=jQuery(this).find(".position_data"),k=d.data("time");
d=d.data("id");c=b-1E3*k;k=calcTimeAgo(c);jQuery(".open_order_age_"+d).text(k)})}function calcTimeAgo(a){var b=Math.floor(a/864E5),c=Math.floor(a%864E5/36E5);a=Math.floor(a%36E5/6E4);return 1<b?b+" days":1==b?"1 day":1<c?c+" hours":1==c?"1 hour":1<a?a+" minutes":1==a?"1 minute":"less than a minute"}function recreateClicks(a){jQuery.each(jQuery(a+" a"),function(a,c){if(jQuery(this).prop("onclick"))jQuery(this).on("click",function(a){jQuery(this).prop("onclick")})})}
function setBulkPercentage(){var a=jQuery("#set_bulk_percentage_profit").val();if(0<a){jQuery(".bulk-percentage-profit").modal("toggle");var b=[];jQuery.each(jQuery(".selectAllBulk"),function(a){this.checked&&b.push(this.value)});0<b.length?jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=bulkpp",data:{percentage:a,pos_i:b},cache:!1,beforeSend:function(){jQuery("#bulkDropdown").html('<i class="fa fa-refresh fa-spin"></i>')},complete:function(){jQuery("#bulkDropdown").html('Bulk actions <span class="caret"></span>')},
success:function(c){if(1==c.status)for(swal({title:"Done",text:"Percentage profit has been set for the selected positions.",timer:3E3,type:"success"}),c=0;c<b.length;c++)jQuery("#percentage_profit_"+b[c]).val(a);else swal({title:"Error",text:c.error,type:"error"})}}):setTimeout(function(){swal({title:"No positions selected",text:"No positions selected. Please select 1 or more positions.",type:"error"})},200)}else swal({title:"No percentage profit entered",text:"You did not enter a percentage profit. Please enter a percentage and click save.",
timer:5E3,type:"error"})}function loadHopperOutputLog(){0!==jQuery("#output-log-table tbody tr").length&&(output_table=jQuery("#output-log-table").DataTable({order:[current_output_order],orderCellsTop:!0,responsive:!1,scrollY:"380px",scrollX:"100%",fixedHeader:!1,scrollCollapse:!0,paging:!1,columnDefs:[{title:"Date",targets:0},{title:"Type",targets:1},{title:"Message",targets:2},{responsivePriority:1,targets:2},{responsivePriority:2,targets:0}]}))}
function appendToHopperLog(a,b,c){if(1==hopper_errors_output&&"info"==b)return!1;output_table?(500<output_table.page.info().recordsTotal&&output_table.row(jQuery("#output-log-table tbody tr:last")).remove(),output_table.row.add([getDateTime(c),b.toUpperCase(),a]),output_table.rows(jQuery("#output-log-table tbody tr")).invalidate().draw()):(jQuery("#output-log-table tbody tr").remove(),c="<tr>"+("<td>"+getDateTime(c)+"</td>"),c+="<td>"+b.toUpperCase()+"</td>",c=c+("<td>"+a+"</td>")+"</tr>",jQuery("#output-log-table tbody").prepend(c),
loadHopperOutputLog())}
function loadHopperOutputData(a){output_table&&output_table.clear().draw();var b=a.result.length;if(0<b){for(var c="",d=0;d<b;d++){var f=a.result[d];output_table?output_table.row.add([getDateTime(f.log_time),f.log_type.toUpperCase(),f.log_output]):(c+="<tr>",c+="<td>"+getDateTime(f.log_time)+"</td>",c+="<td>"+f.log_type.toUpperCase()+"</td>",c+="<td>"+f.log_output+"</td>",c+="</tr>")}output_table?output_table.draw():(jQuery("#output-log-table tbody").html(c),loadHopperOutputLog())}else output_table&&output_table.clear().draw()}
function toggleHopperLive(){setTimeout(function(){jQuery("#hopper-output-live").prop("checked")?(hopper_live_output=1,output_daterange_selected=!1,jQuery("#outputDaterangeClear").hide(),output_table&&output_table.order([current_output_order]).draw(),getCurrentHopperOutputLog()):hopper_live_output=0;jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=setlogsetting",data:{output_live_feed:hopper_live_output},cache:!1,beforeSend:function(){},complete:function(){},success:function(a){}})},
100)}function toggleHopperErrors(){setTimeout(function(){hopper_errors_output=jQuery("#hopper-output-errors-only").prop("checked")?1:0;jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=setlogsetting",data:{output_errors_only:hopper_errors_output},cache:!1,beforeSend:function(){},complete:function(){},success:function(a){}});getCurrentHopperOutputLog()},100)}
function removeOutputDaterange(){output_daterange_selected=!1;jQuery("#outputDaterangeClear").hide();getCurrentHopperOutputLog()}
function selectOuputDateRange(){if(!output_daterange_init)return!1;output_daterange_selected=!0;1==hopper_live_output&&(hopper_live_output=0,jQuery("#hopper-output-live").prop("checked",!1),fireEventSwitchery("hopper-output-live"),jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=setlogsetting",data:{output_live_feed:hopper_live_output},cache:!1,beforeSend:function(){},complete:function(){},success:function(a){}}));getCurrentHopperOutputLog();jQuery("#outputDaterangeClear").show()}
function timezoneOffset(){var a=moment.utc(),b=getUsersTimezone();return moment.tz.zone(b).offset(a)/60}
function getCurrentHopperOutputLog(){var a=0;jQuery("#hopper-output-errors-only").prop("checked")&&(a=1);var b=!1;output_daterange_selected&&(b=jQuery("#hopper-output-daterange").val());jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=outputlog",data:{daterange:b,timezone:timezoneOffset(),errors:a},cache:!1,beforeSend:function(){jQuery("#output-log-table-loader").html('<i class="fa fa-refresh fa-spin fa-lg"></i>')},complete:function(){jQuery("#output-log-table-loader").html('<i class="fa fa-refresh fa-lg"></i>')},
success:function(a){1==a.status?loadHopperOutputData(a):swal({title:"Error",text:a.error,type:"error"})}})}
function refreshWalletScrubber(){jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=getwalletscrubber",data:{},cache:!1,beforeSend:function(){jQuery("#refresh_walletscrubber").html('<i class="fa fa-refresh fa-spin"></i>')},complete:function(){jQuery("#refresh_walletscrubber").html("Refresh")},success:function(a){if(1==a.status){jQuery("#walletscubber_approx_value").html(a.value);jQuery("#walletscubber_approx_costs").html(a.costs);var b="";jQuery.each(a.balances,function(a,d){b+="<tr><td><b>"+
a+"</b></td><td><b>"+parseFloat(d).toFixed(8)+"</b></td></tr>"});jQuery("#walletscubber_scrub_balances tbody").html(b)}else swal({title:"Error",text:a.error,type:"error"})}})}
function startWalletScrubber(){jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=startwalletscrubber",data:{},cache:!1,beforeSend:function(){jQuery(".scrubWallets").hide();jQuery(".scrubstartedbutton").html('<i class="fa fa-refresh fa-spin"></i>');jQuery(".scrubstartedbutton").show()},complete:function(){},success:function(a){1==a.status?(jQuery(".scrubWallets").hide(),jQuery(".scrubstartedbutton").html("Scrub started"),jQuery(".scrubstartedbutton").show(),swal({title:"Started",text:"The wallet scrubber will start soon. ",
timer:3E3,type:"success"})):swal({title:"Error",text:a.error,type:"error"})}})}function openWalletScrubber(){1!=walletscrubber_auto&&refreshWalletScrubber()}function finishWalletScrubber(){refreshWalletScrubber();jQuery(".scrubWallets").show();jQuery(".scrubstartedbutton").hide()}
function syncSelectedPositions(){var a=[];jQuery.each(jQuery(".syncposcheck"),function(b,c){this.checked&&a.push(jQuery(this).val())});if(0>=a.length)return swal({title:"Error",text:"No positions selected to sync.",timer:3E3,type:"error"}),!1;var b={};b.syncpos=a;for(var c=0;c<a.length;c++)b["unsynced_cur_"+a[c]]=jQuery("#unsynced_cur_"+a[c]).val(),b["unsynced_amount_"+a[c]]=jQuery("#unsynced_amount_"+a[c]).val(),b["unsynced_rate_"+a[c]]=jQuery("#unsynced_rate_"+a[c]).val();jQuery.ajax({type:"POST",
dataType:"json",url:"/siteapi.php?todo=syncpositions",data:b,cache:!1,beforeSend:function(){jQuery("#refreshSyncedPos").html('<i class="fa fa-refresh fa-spin"></i>');jQuery("#syncpositionsButton").hide()},complete:function(){jQuery("#refreshSyncedPos").html("Refresh")},success:function(a){1==a.status?(swal({title:"Synced",text:"The selected positions have been synced.",timer:3E3,type:"success"}),setTimeout(function(){refreshUnsyncedPos();jQuery("#syncpositionsButton").show()},500)):swal({title:"Error",
text:a.error,type:"error"})}})}
function refreshUnsyncedPos(){jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=unsyncedpos",data:{},cache:!1,beforeSend:function(){jQuery("#refreshSyncedPos").html('<i class="fa fa-refresh fa-spin"></i>')},complete:function(){jQuery("#refreshSyncedPos").html("Refresh")},success:function(a){1==a.status?(jQuery("#unsynced_pos_table tbody").html(a.result),jQuery('#unsynced_pos_table [data-plugin="switchery"]').each(function(a,c){var b=jQuery(this).data();"secondarycolor"in b&&(b.secondaryColor=
b.secondarycolor);new Switchery(jQuery(this)[0],b)})):swal({title:"Error",text:a.error,type:"error"})}})}
function sellUnsynced(a){swal({title:"Are you sure?",text:"Are you sure you want to sell this amount?",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"Yes, sell now"}).then(function(b){if(!b.value)return!1;b=jQuery("#unsynced_cur_"+a).val();var c=jQuery("#unsynced_amount_"+a).val(),d=jQuery("#unsynced_rate_"+a).val();b&&c&&d&&jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=sellunsynced",data:{cur:b,amount:c,rate:d},cache:!1,beforeSend:function(){jQuery("#refreshSyncedPos").html('<i class="fa fa-refresh fa-spin"></i>');
jQuery("#sell_unsynced_button_"+a).html('<i class="fa fa-refresh fa-spin"></i>')},complete:function(){jQuery("#refreshSyncedPos").html("Refresh")},success:function(b){1==b.status?jQuery("#sell_unsynced_row_"+a).remove():swal({title:"Error",text:b.error,type:"error"})}})})}
function setAutoSync(){var a=0;jQuery("#autosync").prop("checked")&&(a=1);1==a?(jQuery("#autosync_all_coins_div").show(),jQuery("#autosync_all_coins").prop("checked")?jQuery("#autosync_allowed_coins_div").hide():jQuery("#autosync_allowed_coins_div").show()):(jQuery("#autosync_all_coins_div").hide(),jQuery("#autosync_allowed_coins_div").hide());jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=autosync",data:{check:a},cache:!1,beforeSend:function(){},complete:function(){},success:function(a){1!=
a.status&&swal({title:"Error",text:a.error,type:"error"})}})}function setAutoSyncAllCoins(){var a=0;jQuery("#autosync_all_coins").prop("checked")&&(a=1);1==a?jQuery("#autosync_allowed_coins_div").hide():jQuery("#autosync_allowed_coins_div").show();jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=autosync_all_coins",data:{check:a},cache:!1,beforeSend:function(){},complete:function(){},success:function(a){1!=a.status&&swal({title:"Error",text:a.error,type:"error"})}})}
function setAutoSyncAllowedCoins(){var a=[];jQuery.each(jQuery("#autosync_allowed_coins option"),function(b,c){jQuery(this).prop("selected")&&a.push(jQuery(this).val())});jQuery.ajax({type:"POST",dataType:"json",url:"/siteapi.php?todo=autosync_allowed_coins",data:{allowed_coins:a},cache:!1,beforeSend:function(){},complete:function(){},success:function(a){1!=a.status&&swal({title:"Error",text:a.error,type:"error"})}})}
function loadAutosyncAllowedCoinsSelect(){jQuery("#autosync_allowed_coins").multiSelect({selectableHeader:"<strong>Available coins</strong><br><input type='text' class='form-control search-input' autocomplete='off' placeholder='search...'>",selectionHeader:"<strong>Selected coins</strong><br><input type='text' class='form-control search-input' autocomplete='off' placeholder='search...'>",afterInit:function(a){var b=this;a=b.$selectableUl.prev();var c=b.$selectionUl.prev(),d="#"+b.$container.attr("id")+
" .ms-elem-selectable:not(.ms-selected)",f="#"+b.$container.attr("id")+" .ms-elem-selection.ms-selected";b.qs1=a.quicksearch(d).on("keydown",function(a){if(40===a.which)return b.$selectableUl.focus(),!1});b.qs2=c.quicksearch(f).on("keydown",function(a){if(40==a.which)return b.$selectionUl.focus(),!1})},afterSelect:function(){this.qs1.cache();this.qs2.cache()},afterDeselect:function(){this.qs1.cache();this.qs2.cache()}})}
function enableDisableWalletScrubber(a){1==a?jQuery("#walletscrubber_disabled_button").html('<button type="button" class="btn btn-default btn-block waves-effect waves-light m-t-10" data-toggle="modal" onclick="openWalletScrubber()" data-target="#wallet_scrubber_modal"><i class="fa fa-wrench"></i> Wallet Scrubber</button>'):jQuery("#walletscrubber_disabled_button").html('<button type="button" class="btn btn-default btn-block waves-effect waves-light m-t-10" disabled><i class="fa fa-wrench"></i> Hopper disabled</button>')}
function doubleCheckOpenOrders(){if(jQuery("#datatable-openorders")){var a=jQuery("#datatable-openorders tbody tr").length;0<a&&jQuery.ajax({type:"GET",dataType:"json",url:"/siteapi.php?todo=countorders",cache:!1,success:function(b){1==b.status&&b.count!=a&&refreshPositionsAndOrders()}})}}function percentage_format(a){return(Math.round(100*a)/100).toFixed(2)}
function scrollCurrentTarget(a){"up"===a?$("#view_current_target_ta option:selected").prev().prop("selected","selected"):$("#view_current_target_ta option:selected").next().prop("selected","selected");viewCurrentTargetTa()};